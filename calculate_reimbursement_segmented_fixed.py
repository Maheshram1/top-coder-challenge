#!/usr/bin/env python3

import sys
import math

def create_features(days, miles, receipts):
    """Create feature vector"""
    return [
        days, miles, receipts,
        days**2, miles**2, receipts**2, days**3,
        days * miles, days * receipts, miles * receipts,
        days * miles * receipts,
        miles / days if days > 0 else 0,
        receipts / days if days > 0 else 0,
        miles / (receipts + 1),
        (receipts + 1) / miles if miles > 0 else 0,
        math.log(days + 1), math.log(miles + 1), math.log(receipts + 1),
        math.sqrt(days), math.sqrt(miles), math.sqrt(receipts),
        math.sin(days), math.cos(days),
        1 if days == 1 else 0,
        1 if days == 5 else 0,
        1 if days >= 10 else 0,
        1 if miles < 50 else 0,
        1 if miles > 1000 else 0,
        1 if receipts < 50 else 0,
        1 if receipts > 2000 else 0,
        1 if days > 0 and 120 <= miles/days <= 129 else 0,
        1 if days > 0 and 180 <= miles/days <= 189 else 0,
        1 if days > 0 and 210 <= miles/days <= 219 else 0,
        days * math.log(miles + 1),
        receipts * math.sqrt(days),
        miles * math.sqrt(receipts) / (days + 1),
    ]

def predict_with_coefficients(features, coefficients, intercept):
    """Make prediction using coefficients"""
    result = intercept
    for i, coef in enumerate(coefficients):
        result += coef * features[i]
    return result

def calculate_reimbursement(trip_duration_days, miles_traveled, total_receipts_amount):
    """
    Segmented model approach - chooses best model based on input characteristics
    """
    days = int(trip_duration_days)
    miles = float(miles_traveled)
    receipts = float(total_receipts_amount)
    
    features = create_features(days, miles, receipts)
    efficiency = miles / days if days > 0 else 0
    
    # Model coefficients and intercepts
    day_1_coeffs = [-1.7315915409179515e-06, 3.663496755159271, 1.1211300059866571, 1.037350500785253e-06, -0.0021649504279894274, -0.0008318657689253785, -7.904498167121687e-10, 3.663507229513169, 1.1211303051195163, -0.00011128293636157557, -0.00011063903222845147, 3.6635072297352624, 1.121130305293063, -0.34753144730307617, 2.9135545482888774, 5.5692169246815375e-11, 721.8221056570676, 191.86740416395904, 1.7053025658242404e-13, -491.98187331302773, -136.0986543669428, 9.702062482243676e-11, -9.702062482243676e-11, 0.0, 0.0, 0.0, -44.49010070620408, -125.58721262137072, -85.34094750938482, 174.72264351736078, -221.5815065884599, 62.9657477628788, 16.36025528022319, 721.8221056570766, 1.1211303052871728, 0.008434895048235823]
    day_1_intercept = -2608.117484412554
    day_2_coeffs = [5.47938684639741e-07, -0.5589330118653844, 0.7699581306143933, 1.1342917748346192e-06, 0.0001652297562319474, -0.000910673106199594, -6.129203811156003e-10, -1.117874257925273, 1.5399158255452716, -9.7883171707342e-05, -0.00019649764340163976, -0.27946856449589697, 0.38497895639013685, 14.798626144839217, 0.5088754015676661, 1.1223776052625436e-10, -165.2613136021833, 456.95166612352955, 1.6810101848330579e-10, 204.8444395102411, -210.71322893042029, 7.004519579116379e-11, -2.8018078316465518e-11, 0.0, 0.0, 0.0, -397.98939997023336, 80.99780872824289, -26.472094224490387, 131.92841757240436, -0.7630011036903667, -36.38306331546762, -31.160433365777315, -330.52262720437375, 1.0888850038131448, 0.08023617912305409]
    day_2_intercept = 1718.0993201582137
    day_3_coeffs = [-2.6475892640887905e-08, 0.37638695069167233, 0.26391911366382576, -2.2698024072266565e-09, -0.0009983733992006284, -0.0006442271704199999, -1.0523915072724321e-11, 1.12916082331143, 0.7917573358683182, 4.087996473925461e-06, 1.2497718772511578e-05, 0.12546231372548267, 0.08797303730981768, -6.711524604279611, 2.5530305005881266, -1.682145530710933e-14, 43.375322057765985, -2.5953637042102837, -2.801621759203123e-15, -125.30756684751626, -82.22146943355484, -3.338428411591679e-26, -1.3353713646366715e-25, 0.0, 0.0, 0.0, -32.163910647669866, -22.49110320350944, -63.5729855910431, -3.219909763079916, -38.351216327931674, -94.94255285363201, 0.0, 130.12596617329817, 0.45712131068932677, -0.058700025180605936]
    day_3_intercept = -335.5106526811138
    day_4_coeffs = [-1.8177764861742407e-07, -0.23323153939219146, 0.1317698074091763, -2.2595204270114966e-08, 0.0014215923374783174, -0.0005139653278098951, -5.192291041566932e-12, -0.9329263007311397, 0.52707931194701, 1.1197940126993616e-05, 4.376842685862743e-05, -0.058307893795562726, 0.03294245699668654, -6.296679821758945, 0.7468254023672686, 4.774514562724089e-15, 0.4741901678647782, 15.756178864780125, 0.0, 135.23374911294957, -63.13305425194286, 8.054925925927855e-26, 0.0, 0.0, 0.0, 0.0, 619.365730732996, -105.85289228275154, -6.5735426115521145, -53.04286647713602, 0.0, 127.23077108185298, 115.09986224464767, 1.8967606714589822, 0.2635396559735188, -0.08344907952422424]
    day_4_intercept = -458.43991828734147
    day_5_coeffs = [-1.3018506197347795e-05, -0.14501606720497207, -0.05241159034233003, 1.195372441305069e-07, 0.00031390568349347033, -0.00016041394371851236, 1.1592504733926035e-10, -0.7250826574279586, -0.2620574832700452, -3.162139024701362e-05, -0.0001566339546824472, -0.029003306252440707, -0.01048229868424398, 10.943416635333044, 16.476580049545174, -9.125469370121299e-13, -25.521766783441503, -1685.6568240008287, -7.612262247967762e-13, 204.05087152217263, 265.658948167076, 6.618026442747479e-23, -2.0669435631937518e-23, 0.0, 0.0, 0.0, -736.0429076165127, -25.70386656396209, -792.0437923984186, 163.66379820256773, 99.75550763250847, -19.6291141040535, -11.892006077361302, -127.60883391723515, -0.11719566868758297, 0.3307909545579907]
    day_5_intercept = 7261.540822016548
    day_6_coeffs = [0.00011822726451825954, -0.2586066970231263, -0.3404860096705428, 6.358955621886672e-07, 0.0024325923828339355, 0.0006566078616672586, -3.106117918427742e-09, -1.5517789454367088, -2.0430762160545393, 9.20820094219217e-05, 0.0002243902273661708, -0.04310496942544256, -0.056752115506979624, -519.8466933645526, 12.932950770342023, 5.531045315181022e-13, -70.14291932910562, -9253.951020262057, -1.2357555842335645e-19, 748.8708736582498, 1487.9559526514995, 0.0, 1.2181320347353762e-22, 0.0, 0.0, 0.0, -3002.209088645592, -44.30290878905147, 3156.7687831488925, -21.879515846417284, -7.842041457096936, 0.0, 0.0, -420.85751597436627, -0.8340822029513417, -1.0513817414468545]
    day_6_intercept = 37775.59426002746
    day_7_coeffs = [-0.0006522869886331959, 0.48847926054205815, -0.03560756864090252, -5.430163716290152e-06, -0.005092452550057012, 7.180485383141378e-05, 2.0521326860034605e-09, 3.420732393021117, -0.24979804919240814, 0.00012082524203912977, -0.00028370697901866377, 0.06981086644529526, -0.005097907405952841, 225.02067522070163, -16.016797202088977, 7.43176714713179e-13, 92.9685245349469, -864.6960186912952, 9.927749901883983e-19, -1369.1260059311746, 210.83996830558962, -2.032046542655782e-22, -2.378096580001942e-22, 0.0, 0.0, 0.0, 4710.041030660637, 219.76507803514048, -11666.333840991498, 37.90499647070156, -21.758672040513087, 0.0, 0.0, 650.7796717472934, -0.09441450616640952, 1.0889620911563134]
    day_7_intercept = -7802.901847577298
    day_8_coeffs = [-0.00014183483964793505, 0.09352934366572209, -0.2985911795629592, 4.3192118474833733e-07, -0.00047676563110264376, 0.001489139020992925, 9.9550101495538e-10, 0.7476502293221744, -2.3886859043207638, -1.2155431552805337e-05, -8.782671476971393e-05, 0.011682034834712139, -0.03732321725725955, -220.97608275186428, 2.2389186571183317, 5.7750678352437864e-12, 17.126726103706623, -10476.452020189725, -9.413211133871921e-20, -318.7070024801836, 1884.9358900726652, 1.0666331300523186e-22, 3.5587891071335487e-23, 0.0, 0.0, 0.0, 293.8359573725001, -94.25048682498601, -3671.1566122875834, 133.3036064569017, 144.48159923248048, 0.0, 0.0, 137.0138088296973, -0.844528145511563, 0.24753873671134022]
    day_8_intercept = 31809.0372173073
    day_9_coeffs = [-5.390539808120483e-06, -0.0685709317772712, 0.024110733236755954, -1.6681415797303867e-09, 0.0020727476604248314, -0.000682304841699923, -2.724220848904224e-11, -0.617148745047393, 0.21699270449186778, -4.429508359560449e-06, -5.530218441832257e-05, -0.007619120294877881, 0.0026789223806869254, -69.79380761168626, 2.0554935476525054, 9.350932491805618e-15, -7.5277408029328825, -1124.5034679212888, 0.0, 244.80640055461794, 74.38691867776232, 1.8889771071980536e-24, 1.0143289949661052e-23, 0.0, 0.0, 0.0, -273.5761327302301, -107.10611150144213, 338.8504812553167, 287.2021214851241, -62.202197530430674, 0.0, 0.0, -67.74966722638935, 0.07233090235813908, 0.06942930498023467]
    day_9_intercept = 6157.1171139706885
    day_10_coeffs = [-6.210608886264368e-05, 0.13944383347516726, -0.08440759731875677, -3.7503121669410153e-07, -0.002803179318592799, 0.0005445245323673887, 1.720210640598907e-10, 1.3943409513600515, -0.8440671663986428, -1.664727554223543e-05, -7.444032061485111e-05, 0.013943419254139404, -0.008440671235305066, -44.65972340325923, 1.9719613306588684, -9.999296823399474e-13, 19.710160666617785, -4574.927726918493, -2.325679959019139e-23, -650.3337033844923, 855.388781275264, -5.8141998975478476e-24, 1.8433070498806137e-23, 0.0, 0.0, 0.0, 1452.9498108864505, 125.8538338557492, -1342.037058157259, 4.124655383268961, 0.0, 0.0, 0.0, 197.10160666614766, -0.26691744868500944, 0.32918437547320506]
    day_10_intercept = 10643.496321222276
    day_11_coeffs = [6.978839274983836e-06, -0.012639938383411414, -0.027779780916506593, -1.6297300290454148e-07, 0.000709697348218812, 0.00010024867882181018, 5.853766499308577e-10, -0.1390992728528993, -0.30557864350337083, -4.580245980335292e-06, -8.863050231596234e-05, -0.0011495807654433184, -0.0025254429697272643, 39.105140600652085, 0.10396498246113686, 2.2773576531180695e-13, 1.693471989070295, -2298.2034780216727, -5.714274647943021e-23, -4.500031736521272, 407.07434203184863, 1.654037695866165e-23, 7.939921813158969e-26, 0.0, 0.0, 0.0, 183.26982687517807, 10.240697932341597, -1932.3629374716393, -28.535196504146096, 0.0, 0.0, 0.0, 18.62819187962573, -0.09213541890931026, 0.71830152715743]
    day_11_intercept = 7041.408439912822
    day_12_coeffs = [1.622933778294093e-05, 0.016074573748651646, -0.01972242750537212, -3.071849136504815e-07, -0.00042644896977045356, -1.008465874994699e-05, -1.4636014622482207e-10, 0.19292118008973175, -0.23666747445258277, 4.619136737361103e-06, 1.856616096683628e-05, 0.0013397303225438119, -0.0016435239821540515, -25.856360338125484, -1.9804324380297929, 6.283848946704431e-13, -0.9659908330750197, -1639.1880985667474, 3.435526037761032e-23, -5.815411445660664, 347.5828731046765, -3.219896897695829e-24, 1.4006677033466073e-23, 0.0, 0.0, 0.0, -21.55017067094584, 38.58240871821257, -62.77298365333941, 9.567268352097877, 0.0, 0.0, 0.0, -11.5918899968095, -0.06832001577472677, -0.47186827916068913]
    day_12_intercept = 5485.879932450483
    day_13_coeffs = [7.661613964836464e-06, 0.0174469227216736, -0.0006265357088903467, -3.3479037993341e-06, -0.0009132790234128975, -0.00011525354640675528, 2.744142690858098e-10, 0.22735003458525707, -0.008081308455975827, -3.8080049473355797e-06, -5.8003825277387044e-05, 0.0013452663633606256, -4.781877919287291e-05, 13.88000154485485, -0.018549881961464794, -2.6502497348907207e-13, 0.029533106711816304, -340.5679377306089, -1.3085790408758783e-21, -73.42282562202217, 82.31179010390622, 1.1682666069108936e-22, -1.4025005152468824e-22, 0.0, 0.0, 0.0, -166.40182442397963, 48.321265480135516, -419.5513177457678, -59.989612249564324, 0.0, 0.0, 0.0, 0.38393038742852414, -0.0022413404402075263, 0.4779939107354825]
    day_13_intercept = 1832.87487815584
    day_14_coeffs = [-2.0057530060922714e-05, 0.12345103015921775, -0.0009858347191059162, 1.0291496506083589e-07, -0.0048985211320268, -0.0003345494733894886, 1.3375078822264186e-11, 1.728245403271082, -0.013829052358161415, -3.173025824876727e-06, -2.874202622650594e-05, 0.008817578740974009, -7.055653225968483e-05, -26.64201758699918, -2.173111394460797, 2.580753280723451e-13, 18.92403731233625, -1623.008293261846, -2.1310980744766583e-23, -1169.3067606997802, 211.4220236459629, -5.327745186191646e-24, -1.677505674494364e-24, 0.0, 0.0, 0.0, 243.56793805110206, 172.22955901855102, 0.0, 8.17500964664214, 0.0, 0.0, 0.0, 264.93652237276416, -0.0036959732482160037, 0.16148324631273053]
    day_14_intercept = -1228.00126196184
    eff_0_coeffs = [-35336.90050100192, -9.620340191560967, 4.305939567405541, 322.941297616126, 0.005080280746252946, -0.000639200545816979, -1.1916323102427122, 0.02467880367119041, 0.07966410415468832, 0.001084926139656965, -7.699573334461269e-05, 9.936906796799132, -0.21735758977076192, -2.048301633175651, -0.2409838307705031, -237253.8593469708, -511.2222665120947, 71.42765652347099, 321212.18133620755, 258.50182856192407, -96.09186614452834, -29.957701852495834, 38.96783010615632, 2219.9303469876595, 5.472172854010048, -44.47389841765749, 46.32745194521942, 4.49108483735472e-09, -158.18468944863125, -77.73367323033713, 3.346940502524376e-10, 0.0, 0.0, 8.511971642485985, -0.4877791746759188, -0.33764816388994373]
    eff_0_intercept = -123350.45030980019
    eff_50_coeffs = [-34685.16944536363, 25.975236021841457, -0.5184137709648919, 332.1466934666762, -0.0026894865046510714, -0.0004129203108004131, -1.7983930002059796, -0.26491038186209975, -0.28037475287386143, -0.0026296040442364125, 0.00013534439123618345, -15.065699910753414, -0.03778949667370755, 2.549207521771131, 131.73151442758618, -227814.4906917918, 6844.180855885318, -296.5293875396105, 307818.481857241, -1574.952865609038, -34.1637621415249, -39.262448383548865, 58.722286748573445, 2825.402023694467, 71.77988677831543, 50.2363484921427, -3.663444658741355e-09, 39.81217783494867, -173.61426792542187, 67.25950704330512, -9.968061931431293e-10, 0.0, 0.0, 118.46815771403428, 1.6902370955157744, 0.8581746676695429]
    eff_50_intercept = -134529.42954683947
    eff_100_coeffs = [356164.80002208916, -19.604848689980788, 2.7247855888878196, -49.68204602361421, 0.005544451993171592, -0.0006122156767007915, -111.56934294595018, -0.9128678812416807, 0.10771919561708258, -0.0007749606108199446, -2.3027148681471094e-05, -4.600387975314047, -0.47958740105491, 0.25688535250825434, 88.75959021170736, 2831298.452833411, -3361.85668293696, 30.639418637112236, -3684128.184176776, 894.1627133644481, -88.1402885317387, 357.89866110443546, 932.4437189692562, -20347.45073299786, 103.2569329979212, -289.3516443396707, -2.283195499330759e-08, 88.63178859592576, 143.13659303806713, 125.20633000724962, 32.15149709095613, -7.275957614183426e-09, 0.0, 658.8556911174372, -0.10066504339346234, 0.44603295048286673]
    eff_100_intercept = 1391508.9559187775
    eff_150_coeffs = [-3003.300366673055, -127.65418507409615, -24.348516065513746, -11729.438055863126, 0.022747754299088582, 5.644549075384166e-05, 685.5669339311265, -6.899980797063631, -4.461698471743059, -0.004370844655845228, 0.0008202156588647312, 221.0262319190367, 23.657361300457765, -147.38736848004163, -3341.9532582876323, -799.4930462883902, -75799.49562614133, -3720.2121022110628, -884.5787808393864, 6195.915291211283, 899.891561703022, 1013.0405913733647, 3458.326744807836, -3894.7319999793, -74.29849002157948, 4.274625098332763e-11, 7.548806024715304e-11, 25.728234989803482, 968.0654606133874, 141.57221006614702, 0.0, 7.74269329816273, 0.0, 11619.731983725596, 18.118987247010402, -2.004715401237176]
    eff_150_intercept = 262073.37359349715
    eff_200_coeffs = [307083.68556272925, 2059.6173088711203, -332.4211650452604, 763070.2787737591, -0.6677323753374078, 0.0015415247994843807, -45318.77261079595, 318.3644191767382, -78.28561460623389, -0.07826258992103992, 0.013568416658034268, -6676.153937471142, 246.8371725477394, -531.3361863578323, -36307.88182845502, 123550.97828360443, 737744.2589736793, -15053.584413367003, 125893.39039413532, 110975.13593795715, 4039.32566918362, -53383.85722486171, -408347.4825775938, -199590.48219300152, 33969.64937245173, 2.3283064365386963e-10, 0.0, 20224.904954628648, 0.0, 102.5556936272993, 0.0, 0.0, 194.5124842370381, -695110.5103594824, 310.28975067342407, -9.251246760154928]
    eff_200_intercept = -1629192.2269334898
    eff_250_coeffs = [-20602.736917925176, -77.68886937314772, 5.451390304675274, -52085.01944349582, 0.030103863645704793, 0.0001997708530803753, 3029.7384133321416, -22.175110893728906, 3.467902649311247, 0.001211475037296156, -0.0004860971447365445, 374.1296667873734, -1.4772839834783815, -59.32177611727228, -358.49921756778906, -8137.311986276287, -75528.17807724416, -3114.4760773600424, -8313.59931875797, -6191.469322125426, 569.4223452525364, 5003.822566372178, 29383.530676294755, 10646.044776560686, 0.0, 0.0, 0.0, -16.910301803854278, 0.0, 7.315824023925182, 0.0, 0.0, 0.0, 46944.912398600914, -11.542811475853544, -0.14777333679060958]
    eff_250_intercept = 248506.56771747643
    comb_1_0_coeffs = [7.08746754861378e-14, -0.0037644610951837187, 0.2096691665055497, 0.0, -0.13188601789294044, -0.00024233821671176866, 0.0, -0.0037644610951848368, 0.20966916650554976, 0.0011544242926685, 0.0011544242926685, -0.0037644610951848368, 0.20966916650554976, -0.0008494451635688424, 0.037557617111675656, 0.0, -0.00020850824506612746, 0.0012870975968848287, 0.0, -0.00045298313976756065, 0.007737352846170193, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.0003504008560728774, -5.227680042888409e-05, 0.0, 0.0, 0.0, -0.00020850824506612746, 0.20966916650554976, 0.08505123122523053]
    comb_1_0_intercept = 395.3169240538464
    comb_1_50_coeffs = [-7.748229141624208e-13, -0.3888080351220367, -0.3055429865961683, 0.0, 0.01297979076469724, -0.24136159494016793, 0.0, -0.38880803512206946, -0.3055429865961928, 0.21349527343981206, 0.21349527343981206, -0.38880803512206946, -0.3055429865961928, 2.0372963836236067, -0.008471915554109009, 0.0, -0.012262546909045248, -0.1627008003156597, 0.0, -0.037041500111502035, -0.15907274494299484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0016016594612479668, 0.0, 0.0, 0.0, 0.0, -0.012262546909045248, -0.3055429865961928, -3.0564108229023406]
    comb_1_50_intercept = 209.97298774929482
    comb_1_100_coeffs = [5.876278738776997e-13, 7.905458969779818e-05, 0.0004755956462600646, -2.7755575615628914e-17, 0.005942622081731497, 0.0005080132462493414, 0.0, 7.905458969834459e-05, 0.00047559564626006845, -0.0031250529337534996, -0.0031250529337534996, 7.905458969834459e-05, 0.00047559564626006845, -0.015215785814520795, 7.361612103484063e-06, 0.0, 9.792045291676667e-07, 0.0014590121021988067, 0.0, 4.5880294971114785e-06, 0.0022142150096260975, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00013874307907467051, 1.8985761151250451e-06, 1.8985761151250451e-06, 0.0, 0.0, 9.792045291676667e-07, 0.00047559564626006845, 0.15412310447461627]
    comb_1_100_intercept = 51.39908555632985
    comb_2_0_coeffs = [3.2531631468518674e-12, -0.08112998189858654, 0.02900843886524747, -6.314393452555578e-16, 0.008952363456135932, 3.530597389072298e-05, 0.0, -0.16225996379717336, 0.05801687773050986, 0.0013596769726248483, 0.0027193539452496965, -0.04056499094929334, 0.014504219432627466, 0.024028171454058944, -0.0040544845616350845, 0.0, -0.006297290282561935, -0.020209912233591105, 0.0, -0.012243710873890392, -0.02749196118554973, 1.3906410756996538e-30, 0.0, 0.0, 0.0, 0.0, -0.0012167890749567782, 0.0, -0.0006713680803372509, -3.231134640440226e-06, 0.0, 0.0, 0.0, -0.01259458056512387, 0.04102412766651284, -0.15984202557920027]
    comb_2_0_intercept = 207.81562937957113
    comb_2_100_coeffs = [-2.0153394301699115e-09, 12.017944968508834, 0.20951790589329547, 7.375211552584915e-13, -0.11706771913161299, -0.0008221425995470407, 7.105427357601002e-15, 24.035889945566808, 0.41903581196774764, 0.0020482716252629425, 0.004096543250525885, 6.008972486391702, 0.10475895299193691, 7.064914041623115, -1.386315328265303, 0.0, 0.08714142593263512, -1.6885248844112972, -1.4190019325134246e-25, 0.5447160848028948, -4.196586965292421, -7.095009662567123e-26, 3.5475048312835615e-26, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8619492377411132, 35.84461365367789, -17.697893057659495, 0.0, 0.0, 0.17428285186527023, 0.2963030642042083, -1.2060040129338772]
    comb_2_100_intercept = -7363.973978115195
    comb_3_0_coeffs = [0.0003017614960993658, -177.21327184919724, -0.8901332903334177, -1.571940381195347e-07, 4.025333969016656, 0.001210745436031425, 1.02384589695248e-08, -531.6397254760386, -2.67038796741543, -0.0023415927522801574, -0.007051455110362538, -59.07108060796791, -0.2967097987657646, -18.99703114574195, 252.05969637223805, 0.0, 4820.386136117045, -1243.6619883695976, 3.302301551741122e-20, 9941.459941755664, 526.3467798107745, -4.127876939676403e-21, 1.651150775870561e-20, 0.0, 0.0, 0.0, 5870.028976380846, 0.0, 2983.206741746222, -113.00282802897635, 0.0, 0.0, 0.0, 14461.158408352969, -1.5417491149035951, 6.098661876285264]
    comb_3_0_intercept = -184624.51799983685
    comb_3_50_coeffs = [0.1950236726771302, 255.96852783146412, -2.212758642426152, 6.168765687801503e-05, -1.0438997330479605, 0.0012322340616107007, 4.063730330017279e-08, 767.8969199069368, -6.630066225436594, 0.008680313092113841, 0.0023437987845080326, 85.32188024993563, -0.7366597552008016, -3011.7492055315374, 479.8828018690749, 2.7755575615628914e-17, 27173.066580369246, -15496.43782004108, -2.9128322612960354e-15, -99116.7010890221, 2436.3902982494733, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6874.310189969035, 18.736668244742056, 0.0, 0.0, 0.0, 81519.19974015921, -3.827846806263964, -2.305554515648928]
    comb_3_50_intercept = -457655.6207867144
    comb_3_100_coeffs = [-5.795796337976743e-12, 0.016805006942521676, 0.06686358061928309, -2.4702462297909733e-14, 0.0006124056134882096, 4.066703933672911e-06, 0.0, 0.050415020828484605, 0.20059074185788697, -0.0004267964478622465, -0.0012803893465213564, 0.0056016689809426454, 0.022287860206431163, -0.0018452280983969995, -0.00012086466224660231, 0.0, 9.091238659691456e-05, 0.0010829782637138898, 1.5317288957841894e-32, 0.0006565602040230354, 0.00674336522198423, 0.0, -7.658644478920947e-33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.0031399211441814974, 0.00396315229312985, 0.0, 0.0, 0.0002727371597907524, 0.11581111880859063, 0.7363513705867715]
    comb_3_100_intercept = -375.99586439105633
    comb_3_150_coeffs = [-5.083129555293053e-13, 0.01083014096610585, 0.2786453827546256, 4.440892098500626e-16, 0.00448056353663612, -0.0004166135608957406, 0.0, 0.032490422898533725, 0.8359361482638059, -0.00022864389333716065, -0.0006859316802323108, 0.0036100469887259583, 0.09288179425153396, 0.009675575239030813, 0.0010148635864815697, 0.0, 4.2170739475217534e-05, -0.0010787778158456614, 0.0, 0.0003588571914883142, 0.0010882656770408012, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00024302079771695427, 0.0, -0.002339591202644166, 0.0, 0.00012651221842563363, 0.48262796022544685, -0.4375677866844914]
    comb_3_150_intercept = -343.14799804257564
    comb_3_200_coeffs = [-5.058398593873678e-09, 18.480184499529802, 2.0688013599513226, -4.061417868683748e-12, -0.0959945176577742, -0.005836937272850951, 0.0, 55.44055350673382, 6.206404088861034, 0.001872413393623419, 0.005617237841968255, 6.160061500749575, 0.6896004543201449, 2.3983513601895794, -0.24313803605769763, 0.0, 0.06114057281736961, -0.49174510964965484, -3.448864227833507e-24, 0.5648090298906946, -1.4614499567418293, 0.0, 1.7244321139167534e-24, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.30404636160219034, 0.0, 0.0, 0.0, 0.18342171845210065, 3.583269071413824, -9.411163033701028]
    comb_3_200_intercept = -64889.53666707822
    comb_4_0_coeffs = [0.31625682558686663, 45.22029414640052, 22.883104303202447, 0.00013512292661843617, -3.2030348112652476, -0.013764346011901065, -5.146597885641313e-07, 180.39267316089564, 91.54312405619763, -0.05551942997066655, -0.22207770479081665, 11.274542074770403, 5.721445251311687, 524540.1537984972, -740.4002972212404, -1.0511584861177433e-16, 4635.221613683776, 505178.79301948776, 0.0, -67637.53205186914, -59519.14531807378, 0.0, 0.0, 0.0, 0.0, 0.0, 49586.80894924955, 0.0, 0.0, 1279.8106862382729, 0.0, 0.0, 0.0, 18540.886454735104, 45.771562015510014, 446.89967404392286]
    comb_4_0_intercept = -2040806.8598058564
    comb_4_50_coeffs = [4.177359802237, 866.9138561150565, -7.775153239150287, 0.0006834874181798067, -4.1403350427495695, 0.01089596997631003, -5.503244437932153e-08, 3468.5736379851014, -30.914672691082075, -0.003151065999624009, -0.01260445791549938, 216.78585237047056, -1.9321670453802453, -26706.483952333292, -6578.802216112313, 6.077775047497856e-14, 117043.70695256039, -150462.69096625972, 0.0, -650720.7090852784, 21654.32437606824, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 79013.11103304228, 188.32165844730875, 0.0, 0.0, 0.0, 468174.82781024155, -15.457336361669144, -18.157131079021937]
    comb_4_50_intercept = -3563390.777220548
    comb_4_100_coeffs = [5.699683890561058e-08, 32.21184787990517, 1.9348544270609849, -8.189005029635155e-13, -0.39051827054865085, 0.00567904332793916, 0.0, 128.84739152102284, 7.739417708001523, -0.011050432039565877, -0.04420172815826351, 8.052961970063928, 0.48371360675009517, -1.7760172632285383, -0.5907174226825601, 9.285460207356455e-25, 0.1404069490529053, -0.14279096516366868, 0.0, 1.1296624322443087, -1.9267515865151676, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.09392366425498833, -43.1370106897216, 0.0, 0.0, 0.0, 0.5616277962116212, 3.8697088540007614, 19.39216245133434]
    comb_4_100_intercept = -179801.4079877378
    comb_4_150_coeffs = [-7.245941915088368e-08, 1.4145173383511536, 1.287857289153398, 1.0225598146007542e-11, 0.017811122535080447, -0.005873861404485043, -1.1368683772161603e-13, 5.658069703288796, 5.1514291593330785, 0.0005061227758741277, 0.0020244911034965106, 0.35362935645554977, 0.3219643224583174, -885.1875857047287, 6.133550963886664, -3.674702019097255e-24, -0.14044424110824388, 22.589892271307118, 0.0, -0.6639414711937381, -164.76987899734934, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -405.44367093188674, 0.0, -0.5617769644329755, 2.5757145796665393, -8.317900772735758]
    comb_4_150_intercept = -8727.70716182531
    comb_4_200_coeffs = [8.113408912167265e-07, 64.38988406399463, 1.7872514914333628, -1.7903745153091677e-10, -0.5750661705243536, -0.0038088102045491447, 0.0, 257.5595359322776, 7.149005882559096, -6.352308788563804e-05, -0.00025409235154255215, 16.09747099576735, 0.4468128676599435, -13.440820825979314, 10.276613993933722, -3.0971820706542616e-23, 0.04067249022653697, 18.881235246595935, 0.0, 1.0427474554791918, 142.31958022847843, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1098.5921425895776, 0.0, 0.0, -626.7762117674226, 0.16268996090614787, 3.574502941279548, -11.751561808483077]
    comb_4_200_intercept = -490456.1390646591
    comb_5_0_coeffs = [0.002712822697089146, -38.48459318076716, -0.20642529234752469, 3.3827732892621754e-07, 0.6593864983296798, 0.0012302355604105343, -1.3168737211799453e-09, -192.42303929684064, -1.0321288914406193, -0.0002999354374043881, -0.001314179421767978, -7.696921577074433, -0.041285257073471596, 701.0966141021966, 210.4530762187809, -5.644873473888613e-21, -2067.139463405088, -332.3263317477163, -3.3871315841755026e-20, 28097.66105268789, 180.43687123051708, -5.644873473888613e-21, 2.8224367369443066e-21, 0.0, 0.0, 0.0, -6108.48203231039, 0.0, 0.0, -1776.4806153465377, 0.0, 0.0, 0.0, -10335.697317023203, -0.4615833130103521, 4.42476975723858]
    comb_5_0_intercept = 59784.954634879636
    comb_5_50_coeffs = [0.15107020642827998, 224.50449353531783, -0.22421636000243148, -0.0005914562620096264, -1.3724411616862473, -0.0006273540923751502, -2.0795008026652795e-07, 1122.320239664727, -0.9991690145043971, 0.08456055685261371, -0.014400226548444615, 44.892795483876924, -0.039987238773860435, -354.7981436403622, 1608.0662065643087, -1.0758800694145969e-16, 40225.707286468925, -1093.5283187359114, 0.0, -294097.51862675033, 33.47448932120952, 1.0801173517332365e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 201128.53643446855, -0.4463954986482788, -0.4526184697036755]
    comb_5_50_intercept = -2498653.8750499673
    comb_5_100_coeffs = [77.52511970689959, -1841.7930507390342, -1.004816211438739, -0.005068840438781974, 6.477835305449755, 0.005265345466260901, -1.0523581295274198e-07, -9240.091030823985, -17.89670583514556, 22.823908512983834, -4.560193612340489, -369.6126804273805, -0.726550452749276, -9344.460252762909, -1226.2835574780797, 8.315585494186314e-05, -573954.6807468454, -77605.80827193323, 0.0006652468395349051, 3195829.740088775, 11481.620388687226, 0.00016631170988372628, -6.236689120639741e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 70088.31406638358, 447.26370961091646, 49.64051218586764, 0.0, 0.0, -2869773.402327627, -7.943623989346635, -14.289809585474911]
    comb_5_100_intercept = 44057685.985898145
    comb_5_150_coeffs = [1030.543721890176, 5633.693707981842, 23.22651384352066, -0.015609181326821375, -14.428834430069822, 0.005008928448931185, 2.1588094966773497e-05, 28273.478820583245, -18.715664365178064, -83.86532287217227, 16.77479869956198, 1130.9474382890817, -0.8160938567976185, -3441.3529478536548, -2593.299440977103, -5.548008170136321e-11, 2409845.889631392, -59981.9602192113, -3.3288049238483683e-10, -11446079.608564371, 9386.405522857867, -1.1096016340272642e-10, 4.1610061548104603e-11, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 204.79145659929324, 0.0, -27.744914703080244, 0.0, 12049229.449270023, -8.79063476602643, -6.519844663070875]
    comb_5_150_intercept = -203486792.0820559
    comb_5_200_coeffs = [-37.35943993355418, 385.8354510047098, 4.8442256608806025, 0.00037398580774144347, -1.63930262333617, -0.0037710432463083595, 8.326309952622069e-07, 1919.5714494355734, 40.090332509074074, -22.41291103384072, 4.466552871634126, 76.78308488740906, 1.6030529489689358, 7572.5465785404995, -83381.47528116869, -4.1409665123921623e-13, -54781.684015627936, 88082.58948125737, 0.0, -339827.5000791931, -10857.748394608294, 4.1409665123921623e-13, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 67.72425349739287, 0.0, 0.0, 49.59952382315893, -273908.4202484216, 17.944879852790915, 6.268685144908775]
    comb_5_200_intercept = 11845208.171552325
    comb_7_0_coeffs = [-0.0027756677933291423, 0.7466343073565684, -0.175558662425104, -4.879848654604224e-07, 0.031589117507237696, 0.0005086368385355262, -2.272864563224175e-09, 5.234022353112299, -1.2293947873667324, -0.00019819364073614545, 0.0010390395155444492, 0.10681677071004872, -0.025089828420424537, -1382.6941916205274, -165.54263797884855, 1.576942640085786e-18, 193.684664545215, -6613.758503329664, -7.810129630705047e-20, -2295.916233830551, 1157.8763262977736, 5.878587428627913e-20, 5.878587428627913e-20, 0.0, 0.0, 0.0, 28851.787605522964, 0.0, 0.0, -261.7461235842378, 0.0, 0.0, 0.0, 1355.7926517770147, -0.46466457721668, -7.005009604916349]
    comb_7_0_intercept = -2550.9296260434894
    comb_7_50_coeffs = [1596.277042625792, -7743.286950878649, 213.39138725236882, 1.9888571925976584, 105.38651622612221, -0.2065198872471868, 7.698573634939976e-05, -100312.70237796231, 772.68801723746, 1122.1626138711915, -160.8211590788666, -2047.1079251662015, 15.768489654931095, 397083.66873622645, -224535.96128209235, 3.5554317348884687e-10, -3919705.0839899103, 3354421.5052287425, 3.5554317348884687e-10, 44305601.3806109, -567969.4347820627, 8.888579337221172e-11, 8.888579337221172e-11, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 88869.027465487, 0.0, 0.0, 0.0, -27437935.612845514, 296.6686443671485, 1999.858474441697]
    comb_7_50_intercept = 543090292.2723169
    comb_7_100_coeffs = [-4.2244311183648655, -215.07804033340565, 1.0209157726055218, -0.002033237392141729, 1.0327835766693487, -0.0017142434120886762, 1.024263899473965e-05, -1514.1211151762438, 3.613973239795069, -0.18438353500016627, 0.02446277153870897, -30.90035269702967, 0.0740690231141099, 1179.317464168099, 135.5206313164946, -3.1168742869495654e-10, -93752.65558981369, 13086.455769427539, 2.6005270997283223e-14, 848641.0105627141, -2507.445102640352, -1.3002635498641612e-14, -6.501317749320806e-15, 0.0, 0.0, 0.0, 0.0, 223.0468970807779, -43709.85416087664, 282.20166702626994, -115.11012127338148, 0.0, 0.0, -656268.589071357, 1.3679015695231478, 7.615083307807016]
    comb_7_100_intercept = 15279096.214007897
    comb_7_150_coeffs = [-0.006584627518872964, -52.14735468550726, -8.42015871859729, 6.997940000808001e-07, 0.839704107229563, 0.08727500861640798, -2.3101165425032377e-10, -365.0472152160216, -58.93827766475547, -0.004977324969216096, -0.05727851645673678, -7.449943104390576, -1.2028214299856652, 92782.65678430225, 24257.072015170892, 2.100847827940955e-19, 502.71495383328397, -8343.840001343511, 2.100847827940955e-19, 3188.2601324998313, 18525.630342480305, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -9213.500897201868, 0.0, 0.0, 0.0, 3519.0046770278445, -22.276564629159527, 253.98856446712918]
    comb_7_150_intercept = 656004.0661742864
    comb_10_0_coeffs = [0.00014359158701983464, 0.4651583800325224, -0.48467984471521036, -8.04282294569747e-07, -0.005941854739487709, 0.0030217259976655845, -2.390624587178536e-09, 4.6506472073382294, -4.8473242480022645, -0.00022152452692140816, 0.0013264779469498217, 0.04650647521971409, -0.0484733540864934, -4306.406290560856, -0.4833470617067469, -2.768819414327594e-20, 18.6197339789319, -32361.224377517876, -1.384409707163797e-20, -699.4785089029677, 5148.027787687274, -3.461024267909492e-21, 0.0, 0.0, 0.0, 0.0, 1522.5912927069046, 0.0, 0.0, 107.88728952460937, 0.0, 0.0, 0.0, 186.19733981809816, -1.5328621865234484, -13.209639422974133]
    comb_10_0_intercept = 109564.25560143508
    comb_10_50_coeffs = [0.13474783948390556, -11.897482816822988, -0.18493254979782223, 2.4511156122675182e-05, 0.13083119557196576, 0.0010311721348367931, -1.4938180470380757e-08, -118.87222538545007, -1.8432832954607128, 0.00020569156704758115, 0.00029020258902745456, -1.1887230511632454, -0.018433386058669586, -472.670558949075, 807.0444244751876, 7.097177219606994e-17, -4403.771647201385, -9173.484739426462, 1.4194354439213987e-16, 87695.01713416116, 1645.708674431463, 1.7742943049017484e-17, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2231.7949267723493, 68.77462131767928, 0.0, 0.0, 0.0, -44037.716470599575, -0.5828762539036818, -1.6830691566161762]
    comb_10_50_intercept = 1403590.4563375942
    comb_10_100_coeffs = [1.982119249142227e-11, -0.03037774230178349, 0.08056638009508865, 2.220446049250313e-16, 0.005227278454062642, -0.0014864267430931613, 0.0, -0.3037774230206455, 0.8056638009460517, -3.897090310361765e-05, -0.00038970902012800876, -0.003037774230206398, 0.008056638009460665, 0.028701052363218443, 0.00024600203849948745, 0.0, -5.550812618585423e-05, -0.0010845303953209763, 0.0, -0.0006890346205789954, -0.0018567140386523883, -2.2227900865471114e-31, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0006724490227718337, -0.003285433378541955, 0.0, 0.0, 0.0, -0.0005550812618585169, 0.25477326393381133, -0.3800726503756952]
    comb_10_100_intercept = -2512.549059734979
    comb_14_0_coeffs = [-5.756558047457383e-06, 0.21521710048955658, 0.0283374779315961, -1.2935304161132422e-08, -0.005804713701552602, -0.0010669735791618853, -1.4345857834996423e-11, 3.0129203570914247, 0.39672817832832286, 4.224209037441688e-06, 6.880972221745874e-05, 0.015372042483154203, 0.00202412400913238, -98.4368223050172, -22.518218871640865, 0.0, 31.827664288002765, -161.47328956323278, -3.940627504217638e-23, -1987.0447709619102, -150.76715494372687, -1.4763323875230614e-23, 1.2314460950680118e-24, 0.0, 0.0, 0.0, 556.9847858432603, 0.0, 0.0, 86.79417787047004, 0.0, 0.0, 0.0, 445.58730003194546, 0.10603008927617938, -1.9278411169992995]
    comb_14_0_intercept = -10126.141722815762
    comb_14_50_coeffs = [-6.775626988832835, -26.027531422495983, 0.04329670910329603, -0.0005513341542371236, 0.44280098922079125, 0.0010177775290558233, 1.2510582791946945e-08, -364.7015292993895, 0.4698670104864504, -0.12194305874200369, 0.007688138209722149, -1.8607304554961652, 0.0023745114633635417, 1138.9785547703775, -4631.772796051881, -5.551115123125783e-17, -12641.018678052842, 1944.9797544755127, 7.885245575757677e-16, 425172.405967366, -68.03405820091088, -3.93406775511157e-16, 9.835137624043404e-17, 0.0, 0.0, 0.0, 0.0, 75.39950728793465, 0.0, -31.865333325152935, 0.0, 0.0, 0.0, -176974.26150266954, 0.1258249317557058, 10.210316430618638]
    comb_14_50_intercept = 8427757.542406738

    
    # Model selection logic (priority order for best performance)
    predictions = []
    
    # Try combined models first (most specific)
    if days == 1 and 0 <= efficiency < 50:
        pred = predict_with_coefficients(features, comb_1_0_coeffs, comb_1_0_intercept)
        predictions.append(pred)
    if days == 1 and 50 <= efficiency < 100:
        pred = predict_with_coefficients(features, comb_1_50_coeffs, comb_1_50_intercept)
        predictions.append(pred)
    if days == 1 and 100 <= efficiency < 150:
        pred = predict_with_coefficients(features, comb_1_100_coeffs, comb_1_100_intercept)
        predictions.append(pred)
    if days == 2 and 0 <= efficiency < 50:
        pred = predict_with_coefficients(features, comb_2_0_coeffs, comb_2_0_intercept)
        predictions.append(pred)
    if days == 2 and 100 <= efficiency < 150:
        pred = predict_with_coefficients(features, comb_2_100_coeffs, comb_2_100_intercept)
        predictions.append(pred)
    if days == 3 and 0 <= efficiency < 50:
        pred = predict_with_coefficients(features, comb_3_0_coeffs, comb_3_0_intercept)
        predictions.append(pred)
    if days == 3 and 50 <= efficiency < 100:
        pred = predict_with_coefficients(features, comb_3_50_coeffs, comb_3_50_intercept)
        predictions.append(pred)
    if days == 3 and 100 <= efficiency < 150:
        pred = predict_with_coefficients(features, comb_3_100_coeffs, comb_3_100_intercept)
        predictions.append(pred)
    if days == 3 and 150 <= efficiency < 200:
        pred = predict_with_coefficients(features, comb_3_150_coeffs, comb_3_150_intercept)
        predictions.append(pred)
    if days == 3 and 200 <= efficiency < 250:
        pred = predict_with_coefficients(features, comb_3_200_coeffs, comb_3_200_intercept)
        predictions.append(pred)
    if days == 4 and 0 <= efficiency < 50:
        pred = predict_with_coefficients(features, comb_4_0_coeffs, comb_4_0_intercept)
        predictions.append(pred)
    if days == 4 and 50 <= efficiency < 100:
        pred = predict_with_coefficients(features, comb_4_50_coeffs, comb_4_50_intercept)
        predictions.append(pred)
    if days == 4 and 100 <= efficiency < 150:
        pred = predict_with_coefficients(features, comb_4_100_coeffs, comb_4_100_intercept)
        predictions.append(pred)
    if days == 4 and 150 <= efficiency < 200:
        pred = predict_with_coefficients(features, comb_4_150_coeffs, comb_4_150_intercept)
        predictions.append(pred)
    if days == 4 and 200 <= efficiency < 250:
        pred = predict_with_coefficients(features, comb_4_200_coeffs, comb_4_200_intercept)
        predictions.append(pred)
    if days == 5 and 0 <= efficiency < 50:
        pred = predict_with_coefficients(features, comb_5_0_coeffs, comb_5_0_intercept)
        predictions.append(pred)
    if days == 5 and 50 <= efficiency < 100:
        pred = predict_with_coefficients(features, comb_5_50_coeffs, comb_5_50_intercept)
        predictions.append(pred)
    if days == 5 and 100 <= efficiency < 150:
        pred = predict_with_coefficients(features, comb_5_100_coeffs, comb_5_100_intercept)
        predictions.append(pred)
    if days == 5 and 150 <= efficiency < 200:
        pred = predict_with_coefficients(features, comb_5_150_coeffs, comb_5_150_intercept)
        predictions.append(pred)
    if days == 5 and 200 <= efficiency < 250:
        pred = predict_with_coefficients(features, comb_5_200_coeffs, comb_5_200_intercept)
        predictions.append(pred)
    if days == 7 and 0 <= efficiency < 50:
        pred = predict_with_coefficients(features, comb_7_0_coeffs, comb_7_0_intercept)
        predictions.append(pred)
    if days == 7 and 50 <= efficiency < 100:
        pred = predict_with_coefficients(features, comb_7_50_coeffs, comb_7_50_intercept)
        predictions.append(pred)
    if days == 7 and 100 <= efficiency < 150:
        pred = predict_with_coefficients(features, comb_7_100_coeffs, comb_7_100_intercept)
        predictions.append(pred)
    if days == 7 and 150 <= efficiency < 200:
        pred = predict_with_coefficients(features, comb_7_150_coeffs, comb_7_150_intercept)
        predictions.append(pred)
    if days == 10 and 0 <= efficiency < 50:
        pred = predict_with_coefficients(features, comb_10_0_coeffs, comb_10_0_intercept)
        predictions.append(pred)
    if days == 10 and 50 <= efficiency < 100:
        pred = predict_with_coefficients(features, comb_10_50_coeffs, comb_10_50_intercept)
        predictions.append(pred)
    if days == 10 and 100 <= efficiency < 150:
        pred = predict_with_coefficients(features, comb_10_100_coeffs, comb_10_100_intercept)
        predictions.append(pred)
    if days == 14 and 0 <= efficiency < 50:
        pred = predict_with_coefficients(features, comb_14_0_coeffs, comb_14_0_intercept)
        predictions.append(pred)
    if days == 14 and 50 <= efficiency < 100:
        pred = predict_with_coefficients(features, comb_14_50_coeffs, comb_14_50_intercept)
        predictions.append(pred)
    
    # Try day-specific models
    if days == 1:
        pred = predict_with_coefficients(features, day_1_coeffs, day_1_intercept)
        predictions.append(pred)
    if days == 2:
        pred = predict_with_coefficients(features, day_2_coeffs, day_2_intercept)
        predictions.append(pred)
    if days == 3:
        pred = predict_with_coefficients(features, day_3_coeffs, day_3_intercept)
        predictions.append(pred)
    if days == 4:
        pred = predict_with_coefficients(features, day_4_coeffs, day_4_intercept)
        predictions.append(pred)
    if days == 5:
        pred = predict_with_coefficients(features, day_5_coeffs, day_5_intercept)
        predictions.append(pred)
    if days == 6:
        pred = predict_with_coefficients(features, day_6_coeffs, day_6_intercept)
        predictions.append(pred)
    if days == 7:
        pred = predict_with_coefficients(features, day_7_coeffs, day_7_intercept)
        predictions.append(pred)
    if days == 8:
        pred = predict_with_coefficients(features, day_8_coeffs, day_8_intercept)
        predictions.append(pred)
    if days == 9:
        pred = predict_with_coefficients(features, day_9_coeffs, day_9_intercept)
        predictions.append(pred)
    if days == 10:
        pred = predict_with_coefficients(features, day_10_coeffs, day_10_intercept)
        predictions.append(pred)
    if days == 11:
        pred = predict_with_coefficients(features, day_11_coeffs, day_11_intercept)
        predictions.append(pred)
    if days == 12:
        pred = predict_with_coefficients(features, day_12_coeffs, day_12_intercept)
        predictions.append(pred)
    if days == 13:
        pred = predict_with_coefficients(features, day_13_coeffs, day_13_intercept)
        predictions.append(pred)
    if days == 14:
        pred = predict_with_coefficients(features, day_14_coeffs, day_14_intercept)
        predictions.append(pred)
    
    # Try efficiency-based models
    if 0 <= efficiency < 50:
        pred = predict_with_coefficients(features, eff_0_coeffs, eff_0_intercept)
        predictions.append(pred)
    if 50 <= efficiency < 100:
        pred = predict_with_coefficients(features, eff_50_coeffs, eff_50_intercept)
        predictions.append(pred)
    if 100 <= efficiency < 150:
        pred = predict_with_coefficients(features, eff_100_coeffs, eff_100_intercept)
        predictions.append(pred)
    if 150 <= efficiency < 200:
        pred = predict_with_coefficients(features, eff_150_coeffs, eff_150_intercept)
        predictions.append(pred)
    if 200 <= efficiency < 250:
        pred = predict_with_coefficients(features, eff_200_coeffs, eff_200_intercept)
        predictions.append(pred)
    if 250 <= efficiency < 300:
        pred = predict_with_coefficients(features, eff_250_coeffs, eff_250_intercept)
        predictions.append(pred)
    
    # Use best prediction (ensemble average if multiple models apply)
    if predictions:
        result = sum(predictions) / len(predictions)
    else:
        # Fallback: simple linear combination
        result = 59.2 * days + 0.48 * miles + 0.31 * receipts + 120
    
    # Ensure reimbursements are never negative
    result = max(0, result)
    
    return round(result, 2)

if __name__ == "__main__":
    if len(sys.argv) != 4:
        print("Usage: python3 calculate_reimbursement_segmented.py <trip_duration_days> <miles_traveled> <total_receipts_amount>")
        sys.exit(1)
    
    try:
        days = sys.argv[1]
        miles = sys.argv[2]
        receipts = sys.argv[3]
        
        result = calculate_reimbursement(days, miles, receipts)
        print(result)
        
    except Exception as e:
        print(f"Error: {e}", file=sys.stderr)
        sys.exit(1)
